<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cars Addition Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Comic Neue', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .home-button {
            position: fixed;
            top: 25px;
            left: 25px;
            background: white;
            color: #667eea;
            padding: 15px 35px;
            border-radius: 50px;
            border: none;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Comic Neue', cursive, sans-serif;
        }

        .home-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            background: #667eea;
            color: white;
        }

        .home-button:active {
            transform: translateY(0);
        }

        .game-container {
            background: white;
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1400px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .level-info {
            font-size: 1.3em;
            color: #764ba2;
            font-weight: bold;
        }

        .instruction {
            background: #fff4e6;
            border: 3px solid #ffa726;
            border-radius: 15px;
            padding: 15px 25px;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.3em;
            color: #e65100;
            font-weight: bold;
        }

        .boxes-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin-bottom: 30px;
            gap: 20px;
        }

        .box-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .box {
            border-radius: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 20px;
            position: relative;
            transition: all 0.3s ease;
            background: #e8e8e8;
            min-height: 200px;
        }

        .box.left {
            width: 280px;
            border: 4px solid #f57c00;
        }

        .box.middle {
            width: 280px;
            border: 4px solid #1976d2;
        }

        .box.right {
            width: 380px;
            min-height: 240px;
            border: 5px dashed #e91e63;
            box-shadow: 0 0 20px rgba(233, 30, 99, 0.3);
        }

        .box.drag-over {
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(233, 30, 99, 0.6);
            background: #fff8f8;
        }

        .emoji-item {
            font-size: 3.5em;
            cursor: grab;
            user-select: none;
            transition: transform 0.2s;
            position: relative;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }

        .emoji-item:active {
            cursor: grabbing;
        }

        .emoji-item:hover {
            transform: scale(1.1);
        }

        .emoji-item.dragging {
            opacity: 0.5;
        }

        .number-box {
            background: white;
            border: 3px solid #333;
            border-radius: 15px;
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .word {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            align-self: center;
            padding: 0 10px;
        }

        .next-level-btn {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            display: none;
            margin: 20px auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .next-level-btn:hover {
            transform: scale(1.05);
        }

        .next-level-btn:active {
            transform: scale(0.95);
        }

        .restart-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin: 20px auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            display: block;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }

        .restart-btn:active {
            transform: scale(0.95);
        }

        .celebration {
            display: none;
            text-align: center;
            font-size: 2em;
            color: #4caf50;
            font-weight: bold;
            margin-top: 20px;
            animation: bounce 0.5s ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .completion-message {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            display: none;
            margin-top: 20px;
        }

        .completion-message h2 {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .boxes-container {
                flex-direction: column;
            }
            
            .word {
                transform: rotate(0deg);
            }
            
            h1 {
                font-size: 1.8em;
            }

            .home-button {
                top: 10px;
                left: 10px;
                padding: 10px 20px;
                font-size: 1em;
            }

            .box.left, .box.middle, .box.right {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <button class="home-button" onclick="window.location.href='../math-index.html'">üè† Home</button>
    
    <div class="game-container">
        <div class="header">
            <h1>üéØ Drag and Drop Addition üéØ</h1>
            <div class="level-info">Level <span id="current-level">1 (1/7)</span></div>
        </div>

        <div class="instruction" id="instruction">
            Drag and drop the items into the bigger box!
        </div>

        <div class="boxes-container">
            <div class="box-wrapper">
                <div class="box left" id="left-box"></div>
                <div class="number-box" id="left-number">0</div>
            </div>

            <div class="word">and</div>

            <div class="box-wrapper">
                <div class="box middle" id="middle-box"></div>
                <div class="number-box" id="middle-number">0</div>
            </div>

            <div class="word">make</div>

            <div class="box-wrapper">
                <div class="box right" id="right-box"></div>
                <div class="number-box" id="right-number">0</div>
            </div>
        </div>

        <div class="celebration" id="celebration">üéâ Excellent! Well Done! üéâ</div>
        
        <button class="next-level-btn" id="next-level-btn">Next Level ‚ûú</button>
        
        <button class="restart-btn" id="restart-btn">üîÑ Restart Game</button>

        <div class="completion-message" id="completion-message">
            <h2>üèÜ Congratulations! üèÜ</h2>
            <p>You completed all 4 levels!</p>
            <p style="font-size: 3em; margin: 20px 0;">‚≠ê‚≠ê‚≠ê‚≠ê</p>
        </div>
    </div>

    <script>
        // Audio context for sound effects
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(frequency, duration) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        function playDropSound() {
            playSound(523.25, 0.2); // C5 note
        }

        function playSuccessSound() {
            playSound(659.25, 0.15); // E5
            setTimeout(() => playSound(783.99, 0.15), 100); // G5
            setTimeout(() => playSound(1046.50, 0.3), 200); // C6
        }

        // Game levels configuration with variety of emojis (single items)
        const levelPossibilities = [
            // Level 1: Fruits - Sum between 2 and 5 (7 possibilities)
            [
                { leftCount: 1, middleCount: 1, leftEmoji: 'üçé', middleEmoji: 'üçé', name: 'apples' }, // 2
                { leftCount: 1, middleCount: 2, leftEmoji: 'üçå', middleEmoji: 'üçå', name: 'bananas' }, // 3
                { leftCount: 2, middleCount: 1, leftEmoji: 'üçä', middleEmoji: 'üçä', name: 'oranges' }, // 3
                { leftCount: 1, middleCount: 3, leftEmoji: 'üçã', middleEmoji: 'üçã', name: 'lemons' }, // 4
                { leftCount: 2, middleCount: 2, leftEmoji: 'üçì', middleEmoji: 'üçì', name: 'strawberries' }, // 4
                { leftCount: 1, middleCount: 4, leftEmoji: 'üçë', middleEmoji: 'üçë', name: 'peaches' }, // 5
                { leftCount: 2, middleCount: 3, leftEmoji: 'üçâ', middleEmoji: 'üçâ', name: 'watermelons' }  // 5
            ],
            // Level 2: Vehicles - Sum between 2 and 10 (7 possibilities)
            [
                { leftCount: 1, middleCount: 1, leftEmoji: 'üöó', middleEmoji: 'üöó', name: 'cars' }, // 2
                { leftCount: 2, middleCount: 2, leftEmoji: 'üöï', middleEmoji: 'üöï', name: 'taxis' }, // 4
                { leftCount: 3, middleCount: 3, leftEmoji: 'üöô', middleEmoji: 'üöô', name: 'SUVs' }, // 6
                { leftCount: 4, middleCount: 3, leftEmoji: 'üöå', middleEmoji: 'üöå', name: 'buses' }, // 7
                { leftCount: 5, middleCount: 3, leftEmoji: 'üöë', middleEmoji: 'üöë', name: 'ambulances' }, // 8
                { leftCount: 4, middleCount: 5, leftEmoji: 'üöí', middleEmoji: 'üöí', name: 'fire trucks' }, // 9
                { leftCount: 5, middleCount: 5, leftEmoji: 'üöê', middleEmoji: 'üöê', name: 'vans' }  // 10
            ],
            // Level 3: Animals - Sum from 1 to 5 (7 possibilities - includes zero)
            [
                { leftCount: 0, middleCount: 1, leftEmoji: 'üê∂', middleEmoji: 'üê±', name: 'animals' }, // 1
                { leftCount: 1, middleCount: 0, leftEmoji: 'üê∞', middleEmoji: 'üêª', name: 'animals' }, // 1
                { leftCount: 2, middleCount: 0, leftEmoji: 'üêº', middleEmoji: 'ü¶Å', name: 'pandas' }, // 2
                { leftCount: 1, middleCount: 2, leftEmoji: 'üê∏', middleEmoji: 'üê¢', name: 'animals' }, // 3
                { leftCount: 1, middleCount: 3, leftEmoji: 'üêπ', middleEmoji: 'üê≠', name: 'animals' }, // 4
                { leftCount: 2, middleCount: 3, leftEmoji: 'üê∑', middleEmoji: 'üêÆ', name: 'animals' }, // 5
                { leftCount: 0, middleCount: 5, leftEmoji: 'üêØ', middleEmoji: 'ü¶ä', name: 'foxes' }  // 5
            ],
            // Level 4: Shapes - Sum from 1 to 10 (7 possibilities - includes zero)
            [
                { leftCount: 1, middleCount: 0, leftEmoji: '‚≠ê', middleEmoji: 'üíõ', name: 'shapes' }, // 1
                { leftCount: 0, middleCount: 3, leftEmoji: 'üîµ', middleEmoji: 'üü°', name: 'circles' }, // 3
                { leftCount: 2, middleCount: 3, leftEmoji: 'üî∫', middleEmoji: 'üî∂', name: 'shapes' }, // 5
                { leftCount: 3, middleCount: 4, leftEmoji: '‚¨õ', middleEmoji: '‚¨ú', name: 'squares' }, // 7
                { leftCount: 5, middleCount: 3, leftEmoji: 'üü¢', middleEmoji: 'üî¥', name: 'circles' }, // 8
                { leftCount: 4, middleCount: 5, leftEmoji: 'üü£', middleEmoji: 'üü†', name: 'circles' }, // 9
                { leftCount: 0, middleCount: 10, leftEmoji: 'üíö', middleEmoji: 'üíô', name: 'hearts' }  // 10
            ]
        ];

        let currentLevelConfig;
        let currentLevel = 0;
        let currentChallenge = 0;
        let usedChallenges = [];
        let leftBoxItems = [];
        let middleBoxItems = [];
        let rightBoxItems = [];

        function initLevel() {
            const possibilities = levelPossibilities[currentLevel];
            
            if (usedChallenges.length >= possibilities.length) {
                usedChallenges = [];
            }
            
            let randomIndex;
            do {
                randomIndex = Math.floor(Math.random() * possibilities.length);
            } while (usedChallenges.includes(randomIndex));
            
            usedChallenges.push(randomIndex);
            currentLevelConfig = possibilities[randomIndex];
            
            const leftBox = document.getElementById('left-box');
            const middleBox = document.getElementById('middle-box');
            const rightBox = document.getElementById('right-box');
            const instruction = document.getElementById('instruction');
            const celebration = document.getElementById('celebration');
            const nextBtn = document.getElementById('next-level-btn');
            
            // Reset
            leftBox.innerHTML = '';
            middleBox.innerHTML = '';
            rightBox.innerHTML = '';
            leftBoxItems = [];
            middleBoxItems = [];
            rightBoxItems = [];
            celebration.style.display = 'none';
            nextBtn.style.display = 'none';
            
            // Update level info
            document.getElementById('current-level').textContent = `${currentLevel + 1} (${currentChallenge + 1}/7)`;
            instruction.textContent = `Drag and drop the ${currentLevelConfig.name} into the bigger box!`;
            
            // Set the initial numbers
            document.getElementById('left-number').textContent = currentLevelConfig.leftCount;
            document.getElementById('middle-number').textContent = currentLevelConfig.middleCount;
            
            // Create items for left box
            for (let i = 0; i < currentLevelConfig.leftCount; i++) {
                const item = createItem(currentLevelConfig.leftEmoji, 'left', i);
                leftBox.appendChild(item);
                leftBoxItems.push(item);
            }
            
            // Create items for middle box
            for (let i = 0; i < currentLevelConfig.middleCount; i++) {
                const item = createItem(currentLevelConfig.middleEmoji, 'middle', i);
                middleBox.appendChild(item);
                middleBoxItems.push(item);
            }
            
            updateNumbers();
            adjustItemSizes();
        }

        function createItem(emoji, source, index) {
            const span = document.createElement('span');
            span.className = 'emoji-item';
            span.textContent = emoji;
            span.draggable = true;
            span.dataset.source = source;
            span.dataset.index = index;
            
            span.addEventListener('dragstart', handleDragStart);
            span.addEventListener('dragend', handleDragEnd);
            
            return span;
        }

        function handleDragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.innerHTML);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDragEnter(e) {
            if (e.target.classList.contains('box')) {
                e.target.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            if (e.target.classList.contains('box')) {
                e.target.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            e.preventDefault();
            
            const target = e.target.classList.contains('box') ? e.target : e.target.closest('.box');
            if (target) {
                target.classList.remove('drag-over');
            }
            
            const draggingItem = document.querySelector('.emoji-item.dragging');
            if (draggingItem && target && target.id === 'right-box') {
                const source = draggingItem.dataset.source;
                
                const rightBox = document.getElementById('right-box');
                rightBox.appendChild(draggingItem);
                rightBoxItems.push(draggingItem);
                
                if (source === 'left') {
                    const index = leftBoxItems.indexOf(draggingItem);
                    if (index > -1) leftBoxItems.splice(index, 1);
                } else if (source === 'middle') {
                    const index = middleBoxItems.indexOf(draggingItem);
                    if (index > -1) middleBoxItems.splice(index, 1);
                }
                
                draggingItem.dataset.source = 'right';
                
                playDropSound();
                updateNumbers();
                adjustItemSizes();
                checkLevelComplete();
            }
            
            return false;
        }

        function updateNumbers() {
            document.getElementById('right-number').textContent = rightBoxItems.length;
        }

        function adjustItemSizes() {
            const adjustSize = (items, container) => {
                const count = items.length;
                let size;
                if (count <= 2) size = 3.5;
                else if (count <= 4) size = 3;
                else if (count <= 6) size = 2.5;
                else if (count <= 8) size = 2.2;
                else size = 2;
                
                items.forEach(item => {
                    item.style.fontSize = `${size}em`;
                });
            };
            
            adjustSize(leftBoxItems, 'left-box');
            adjustSize(middleBoxItems, 'middle-box');
            adjustSize(rightBoxItems, 'right-box');
        }

        function checkLevelComplete() {
            if (leftBoxItems.length === 0 && middleBoxItems.length === 0) {
                playSuccessSound();
                document.getElementById('celebration').style.display = 'block';
                
                currentChallenge++;
                
                if (currentChallenge >= 7) {
                    if (currentLevel < levelPossibilities.length - 1) {
                        setTimeout(() => {
                            document.getElementById('next-level-btn').style.display = 'block';
                        }, 1000);
                    } else {
                        setTimeout(() => {
                            document.getElementById('completion-message').style.display = 'block';
                        }, 1000);
                    }
                } else {
                    setTimeout(() => {
                        initLevel();
                    }, 1500);
                }
            }
        }

        // Setup drop zone
        const rightBox = document.getElementById('right-box');
        rightBox.addEventListener('dragover', handleDragOver);
        rightBox.addEventListener('dragenter', handleDragEnter);
        rightBox.addEventListener('dragleave', handleDragLeave);
        rightBox.addEventListener('drop', handleDrop);

        // Next level button
        document.getElementById('next-level-btn').addEventListener('click', () => {
            currentLevel++;
            currentChallenge = 0;
            usedChallenges = [];
            initLevel();
        });

        // Restart button
        document.getElementById('restart-btn').addEventListener('click', () => {
            currentLevel = 0;
            currentChallenge = 0;
            usedChallenges = [];
            document.getElementById('completion-message').style.display = 'none';
            initLevel();
        });

        // Initialize first level
        initLevel();
    </script>
</body>
</html>