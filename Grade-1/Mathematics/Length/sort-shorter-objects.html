<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sort Short and Long Objects</title>
    
    <!-- Google Tag Manager -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FTVV63VK10"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FTVV63VK10');
    </script>
    <!-- End Google Tag Manager -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Comic Sans', cursive;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            font-size: 3em;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.3em;
            margin-bottom: 30px;
        }

        .level-indicator {
            text-align: center;
            font-size: 1.8em;
            font-weight: bold;
            color: #764ba2;
            margin-bottom: 20px;
        }

        .instruction-box {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .speaker-btn {
            background: white;
            color: #667eea;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .speaker-btn:hover {
            transform: scale(1.1);
            background: #f0f0f0;
        }

        .speaker-btn.speaking {
            animation: speakerPulse 0.5s ease infinite;
        }

        @keyframes speakerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        .game-area {
            display: flex;
            gap: 40px;
            margin: 40px 0;
            min-height: 500px;
        }

        .column {
            flex: 1;
            border: 4px dashed #ccc;
            border-radius: 20px;
            padding: 20px;
            background: #f8f9fa;
            min-height: 500px;
        }

        .column h3 {
            text-align: center;
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }

        .left-column {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .right-column {
            background: #d4edda;
            border-color: #28a745;
        }

        .right-column.drag-over {
            background: #b8e6c4;
            border-color: #1e7e34;
            border-style: solid;
        }

        .objects-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }

        .draggable-object {
            cursor: move;
            padding: 15px;
            background: white;
            border-radius: 15px;
            border: 3px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            user-select: none;
            touch-action: none;
        }

        .draggable-object:hover {
            transform: scale(1.05);
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .draggable-object.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .draggable-object img {
            height: 70px;
            object-fit: contain;
            pointer-events: none;
        }

        .draggable-object.correct {
            animation: correctPulse 0.6s ease;
            border-color: #28a745;
            background: #d4edda;
        }

        .draggable-object.wrong {
            animation: wrongShake 0.5s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            margin: 20px 0;
            min-height: 60px;
        }

        .feedback.correct {
            color: #28a745;
        }

        .feedback.wrong {
            color: #dc3545;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 35px;
            font-family: 'Comic Sans MS', 'Comic Sans', cursive;
            font-size: 1.4em;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }

        .btn-home {
            background: #FF6B6B;
        }

        .btn-home:hover {
            background: #EE5A5A;
        }

        .btn-check {
            background: #28a745;
        }

        .btn-check:hover {
            background: #218838;
        }

        .btn-next {
            background: #FFA500;
            display: none;
        }

        .btn-next:hover {
            background: #FF8C00;
        }

        .btn-retry {
            background: #dc3545;
            display: none;
        }

        .btn-retry:hover {
            background: #c82333;
        }

        .completion-message {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 20px;
            margin: 30px 0;
            display: none;
        }

        .completion-message.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .completion-message h2 {
            font-size: 2.8em;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 15px;
        }

        .completion-message p {
            font-size: 1.5em;
            color: #fff;
        }

        .attribution {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .attribution a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .game-area {
                flex-direction: column;
                gap: 20px;
            }

            .instruction-box {
                font-size: 1.5em;
                padding: 20px;
            }

            .container {
                padding: 20px;
            }

            .draggable-object img {
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìè Sort the Short and Long Objects üìè</h1>
        <p class="subtitle">Grade 1 - Drag & Drop Activity</p>
        
        <div class="level-indicator" id="levelIndicator">Level 1</div>
        
        <div class="instruction-box">
            <button class="speaker-btn" id="speakerBtn" onclick="speakInstruction()">üîä</button>
            <span id="instructionText">Drag all the <u>shorter</u> objects to the green box!</span>
        </div>
        
        <div class="completion-message" id="completionMessage">
            <h2>üåü FANTASTIC! üåü</h2>
            <p>You completed all levels!</p>
        </div>
        
        <div class="game-area" id="gameArea">
            <div class="column left-column">
                <h3>üì¶ All Objects</h3>
                <div class="objects-container" id="leftContainer"></div>
            </div>
            
            <div class="column right-column" id="rightColumn">
                <h3 id="rightColumnTitle">‚úÖ Short Objects</h3>
                <div class="objects-container" id="rightContainer"></div>
            </div>
        </div>
        
        <div class="feedback" id="feedback"></div>
        
        <div class="buttons">
            <button class="btn btn-home" onclick="window.location.href='../grade-1-math-index.html'">üè† Home</button>
            <button class="btn btn-check" id="checkBtn" onclick="checkAnswer()">‚úîÔ∏è Check Answer</button>
            <button class="btn btn-retry" id="retryBtn" onclick="retryLevel()">üîÑ Try Again</button>
            <button class="btn btn-next" id="nextBtn" onclick="nextLevel()">Next Level ‚û°Ô∏è</button>
        </div>
        
        <div class="attribution">
            <p><strong>Image Attribution:</strong> Images from <a href="https://www.freepik.com" target="_blank">Freepik</a></p>
        </div>
    </div>

    <script>
        // Image pairs
        const imagePairs = [
            { name: 'pencil', long: 'Asset/Pencil_L.png', short: 'Asset/Pencil_S.png' },
            { name: 'ruler', long: 'Asset/Ruler_L.png', short: 'Asset/Ruler_S.png' },
            { name: 'car', long: 'Asset/Car_L.png', short: 'Asset/Car_S.png' },
            { name: 'fish', long: 'Asset/Fish_L.png', short: 'Asset/Fish_S.png' },
            { name: 'train', long: 'Asset/Train_L.png', short: 'Asset/Train_S.png' }
        ];

        let currentLevel = 1;
        let currentObjects = [];
        let draggedElement = null;
        let currentTask = 'short'; // 'short' or 'long'

        function playAudio(audioFile) {
            const audio = new Audio(`Asset/${audioFile}`);
            audio.volume = 1.0;
            audio.play().catch(err => console.error('Audio playback failed:', err));
        }

        function playOopsAudio() {
            // Randomly choose between the two oops audio files
            const oopsAudios = ['oops_keep_trying.mp3', 'keep_tyring.mp3'];
            const randomAudio = oopsAudios[Math.floor(Math.random() * oopsAudios.length)];
            playAudio(randomAudio);
        }

        function speakInstruction() {
            // Play audio based on current task
            const audioFile = currentTask === 'short' 
                ? 'drag_all_the_short_objects_to_the_green_box.mp3'
                : 'drag_all_the_long_objects_to_the_green_box.mp3';
            
            const audio = new Audio(`Asset/${audioFile}`);
            audio.volume = 1.0;
            
            const speakerBtn = document.getElementById('speakerBtn');
            speakerBtn.classList.add('speaking');
            
            audio.onended = () => speakerBtn.classList.remove('speaking');
            audio.onerror = (err) => console.error('Audio playback failed:', err);
            
            audio.play().catch(err => {
                console.error('Audio playback failed:', err);
                speakerBtn.classList.remove('speaking');
            });
        }

        function startLevel() {
            document.getElementById('feedback').textContent = '';
            document.getElementById('checkBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('retryBtn').style.display = 'none';
            
            // Randomly choose short or long
            currentTask = Math.random() > 0.5 ? 'short' : 'long';
            
            // Level 1 = 3 objects, Level 2 = 4 objects, Level 3 = 5 objects, Level 4 = 5 objects
            const numObjects = currentLevel === 1 ? 3 : currentLevel === 2 ? 4 : 5;
            
            // Pick one random object type for this level
            const shuffled = [...imagePairs].sort(() => Math.random() - 0.5);
            const selectedPair = shuffled[0];
            
            // Create a mix of short and long objects (at least 1 of each, rest random)
            currentObjects = [];
            
            // Ensure at least 1 short and 1 long
            currentObjects.push({ type: 'short', image: selectedPair.short, name: selectedPair.name });
            currentObjects.push({ type: 'long', image: selectedPair.long, name: selectedPair.name });
            
            // Fill remaining slots randomly
            for (let i = 2; i < numObjects; i++) {
                const isShort = Math.random() > 0.5;
                currentObjects.push({
                    type: isShort ? 'short' : 'long',
                    image: isShort ? selectedPair.short : selectedPair.long,
                    name: selectedPair.name
                });
            }
            
            // Count how many match the task
            const taskCount = currentObjects.filter(obj => obj.type === currentTask).length;
            const taskWord = currentTask === 'short' ? 'short' : 'long';
            
            document.getElementById('levelIndicator').textContent = `Level ${currentLevel}`;
            
            // Update instruction text
            const instructionText = currentTask === 'short' 
                ? 'Drag all the <u>short</u> objects to the green box!'
                : 'Drag all the <u>long</u> objects to the green box!';
            document.getElementById('instructionText').innerHTML = instructionText;
            
            // Update right column title
            const columnTitle = currentTask === 'short' ? '‚úÖ Short Objects' : '‚úÖ Long Objects';
            document.getElementById('rightColumnTitle').textContent = columnTitle;
            
            // Shuffle all objects
            currentObjects.sort(() => Math.random() - 0.5);
            
            renderObjects();
            setTimeout(() => speakInstruction(), 500);
        }

        function renderObjects() {
            const leftContainer = document.getElementById('leftContainer');
            const rightContainer = document.getElementById('rightContainer');
            
            leftContainer.innerHTML = '';
            rightContainer.innerHTML = '';
            
            currentObjects.forEach((obj, index) => {
                const div = document.createElement('div');
                div.className = 'draggable-object';
                div.draggable = true;
                div.dataset.type = obj.type;
                div.dataset.index = index;
                
                const img = document.createElement('img');
                img.src = obj.image;
                img.alt = obj.name;
                
                img.onerror = function() {
                    console.error('Failed to load image:', this.src);
                };
                
                div.appendChild(img);
                leftContainer.appendChild(div);
                
                // Drag events
                div.addEventListener('dragstart', handleDragStart);
                div.addEventListener('dragend', handleDragEnd);
            });
            
            // Drop zone events
            const rightColumn = document.getElementById('rightColumn');
            rightColumn.addEventListener('dragover', handleDragOver);
            rightColumn.addEventListener('drop', handleDrop);
            rightColumn.addEventListener('dragleave', handleDragLeave);
        }

        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            e.currentTarget.classList.add('drag-over');
            return false;
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            e.preventDefault();
            
            const rightColumn = document.getElementById('rightColumn');
            rightColumn.classList.remove('drag-over');
            
            if (draggedElement) {
                const rightContainer = document.getElementById('rightContainer');
                rightContainer.appendChild(draggedElement);
            }
            
            return false;
        }

        function checkAnswer() {
            const rightContainer = document.getElementById('rightContainer');
            const leftContainer = document.getElementById('leftContainer');
            const objectsInRight = rightContainer.querySelectorAll('.draggable-object');
            const objectsInLeft = leftContainer.querySelectorAll('.draggable-object');
            
            // Count how many match the current task
            const totalTarget = currentObjects.filter(obj => obj.type === currentTask).length;
            const taskWord = currentTask === 'short' ? 'short' : 'long';
            
            // Check if nothing was moved
            if (objectsInRight.length === 0) {
                showFeedback(false, `Drag the ${taskWord} objects to the green box!`);
                playOopsAudio();
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline-block';
                return;
            }
            
            // Check if correct number of objects moved
            if (objectsInRight.length !== totalTarget) {
                showFeedback(false, `You need exactly ${totalTarget} ${taskWord} object${totalTarget > 1 ? 's' : ''}!`);
                playOopsAudio();
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline-block';
                return;
            }
            
            // Check if all moved objects match the task type
            let allCorrect = true;
            objectsInRight.forEach(obj => {
                if (obj.dataset.type !== currentTask) {
                    allCorrect = false;
                    obj.classList.add('wrong');
                    setTimeout(() => obj.classList.remove('wrong'), 600);
                } else {
                    obj.classList.add('correct');
                }
            });
            
            // Also check if any matching ones were left behind
            let leftBehindTarget = false;
            objectsInLeft.forEach(obj => {
                if (obj.dataset.type === currentTask) {
                    leftBehindTarget = true;
                    obj.classList.add('wrong');
                    setTimeout(() => obj.classList.remove('wrong'), 600);
                }
            });
            
            const oppositeWord = currentTask === 'short' ? 'long' : 'short';
            
            if (!allCorrect) {
                showFeedback(false, `Oops! Some ${oppositeWord} ones got mixed in. Try again!`);
                playOopsAudio();
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline-block';
            } else if (leftBehindTarget) {
                showFeedback(false, `You missed some ${taskWord} ones in the yellow box!`);
                playOopsAudio();
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline-block';
            } else {
                showFeedback(true, '');
                const praises = ['brilliant.mp3', 'fantastic.mp3', 'wonderful.mp3', 'You_did_well.mp3'];
                playAudio(praises[Math.floor(Math.random() * praises.length)]);
                
                document.getElementById('checkBtn').style.display = 'none';
                
                if (currentLevel < 4) {
                    setTimeout(() => {
                        document.getElementById('nextBtn').style.display = 'inline-block';
                    }, 1000);
                } else {
                    setTimeout(() => {
                        showCompletion();
                    }, 1500);
                }
            }
        }

        function retryLevel() {
            // Move all objects back to left column
            const rightContainer = document.getElementById('rightContainer');
            const leftContainer = document.getElementById('leftContainer');
            const objectsInRight = rightContainer.querySelectorAll('.draggable-object');
            
            objectsInRight.forEach(obj => {
                obj.classList.remove('correct', 'wrong');
                leftContainer.appendChild(obj);
            });
            
            // Clear feedback and reset buttons
            document.getElementById('feedback').textContent = '';
            document.getElementById('retryBtn').style.display = 'none';
            document.getElementById('checkBtn').style.display = 'inline-block';
        }

        function showFeedback(isCorrect, message) {
            const feedback = document.getElementById('feedback');
            
            if (isCorrect) {
                // Show thumbs up emoji for correct answers
                feedback.textContent = 'üëç';
                feedback.className = 'feedback correct';
                feedback.style.fontSize = '4em'; // Make it big!
            } else {
                feedback.textContent = `üí™ ${message} üí™`;
                feedback.className = 'feedback wrong';
                feedback.style.fontSize = '2em'; // Normal size for text
            }
        }

        function nextLevel() {
            currentLevel++;
            startLevel();
        }

        function showCompletion() {
            const completion = document.getElementById('completionMessage');
            const h2 = completion.querySelector('h2');
            const p = completion.querySelector('p');
            
            h2.textContent = 'üèÜ AMAZING WORK! üèÜ';
            p.textContent = 'You completed all 4 levels! You are a sorting champion! üåü';
            
            completion.classList.add('show');
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('feedback').textContent = '';
            
            playAudio('wonderful.mp3');
            
            const nextBtn = document.getElementById('nextBtn');
            nextBtn.textContent = 'üîÑ Play Again';
            nextBtn.style.display = 'inline-block';
            nextBtn.onclick = () => {
                completion.classList.remove('show');
                document.getElementById('gameArea').style.display = 'flex';
                nextBtn.textContent = 'Next Level ‚û°Ô∏è';
                nextBtn.onclick = nextLevel;
                currentLevel = 1;
                startLevel();
            };
        }

        // Initialize game
        startLevel();
        
        // Disable right-click
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('keydown', e => {
            if (e.keyCode === 123 || 
                (e.ctrlKey && e.shiftKey && e.keyCode === 73) ||
                (e.ctrlKey && e.shiftKey && e.keyCode === 74) ||
                (e.ctrlKey && e.keyCode === 85)) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>
