<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerPoint Karaoke Reading Viewer</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #5a67d8;
            margin-bottom: 20px;
        }
        
        .ppt-viewer {
            display: none;
            margin-top: 20px;
        }
        
        .ppt-viewer.active {
            display: block;
        }
        
        .viewer-frame {
            width: 100%;
            height: 600px;
            border: 3px solid #5a67d8;
            border-radius: 10px;
            background: white;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .control-btn {
            background-color: #48bb78;
            color: white;
        }
        
        .control-btn:hover {
            background-color: #38a169;
            transform: translateY(-2px);
        }
        
        .stop-btn {
            background-color: #f56565;
            color: white;
        }
        
        .stop-btn:hover {
            background-color: #e53e3e;
        }
        
        .file-name {
            background: #e6f2ff;
            padding: 10px 20px;
            border-radius: 8px;
            margin: 15px 0;
            color: #2c5282;
            font-weight: bold;
        }
        
        .karaoke-section {
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(to bottom, #f7fafc 0%, #ffffff 100%);
            border: 3px solid #5a67d8;
            border-radius: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä PowerPoint Karaoke Reading Viewer</h1>
        
        <div id="fileName" class="file-name">üìÑ Loading presentation from Assets folder...</div>
        
        <div class="ppt-viewer active" id="pptViewer">
            <iframe id="viewerFrame" class="viewer-frame"></iframe>
        </div>
        
        <!-- Audio Controls Only -->
        <div class="karaoke-section">
            <div class="controls">
                <button class="control-btn" onclick="startReading()">‚ñ∂Ô∏è Start</button>
                <button class="control-btn" onclick="pauseReading()">‚è∏Ô∏è Pause</button>
                <button class="stop-btn" onclick="restartReading()">üîÑ Restart</button>
            </div>
        </div>
    </div>

    <script>
        // File upload handling
        const uploadSection = document.getElementById('uploadSection');
        const fileInput = document.getElementById('fileInput');
        const pptViewer = document.getElementById('pptViewer');
        const viewerFrame = document.getElementById('viewerFrame');
        const fileNameDiv = document.getElementById('fileName');
        
        // Drag and drop
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.classList.add('dragover');
        });
        
        uploadSection.addEventListener('dragleave', () => {
            uploadSection.classList.remove('dragover');
        });
        
        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });
        
        function handleFile(file) {
            const fileName = file.name;
            const fileExtension = fileName.split('.').pop().toLowerCase();
            
            fileNameDiv.textContent = `üìÑ Loaded: ${fileName}`;
            fileNameDiv.style.display = 'block';
            
            if (fileExtension === 'pdf') {
                // Display PDF
                const fileURL = URL.createObjectURL(file);
                viewerFrame.src = fileURL;
                pptViewer.classList.add('active');
            } else if (fileExtension === 'pptx' || fileExtension === 'ppt') {
                // For PPTX, we need to use Google Docs Viewer or Office Online
                alert('To view PowerPoint files:\n\n1. Export your PPT as PDF first\n2. Upload the PDF file\n\nOR\n\nUse the karaoke reading below with your physical PPT open in PowerPoint!');
            }
        }
        
        // Karaoke Reading Implementation
        const story = `In a small village named Pamplemousses, there lived a kind old man named Mr. Thomas. His eyes were bright and happy, and his long white beard looked soft and fluffy. Every morning, Mr. Thomas walked through the village streets, saying hello to everyone with a big, friendly smile. He helped the baker carry heavy bags of flour and told fun stories to the children at the well-known village garden. Children like to hear his funny stories. He watered plants for sick neighbors and fixed broken fences for elderly friends. Mr. Thomas also shared his fresh vegetables from his garden with families who needed food. When big storms came with loud thunder, Mr. Thomas opened his warm house to his scared dogs looking for a safe place. All the village people loved his caring and helpful ways. One special day, everyone surprised Mr. Thomas with a wonderful party to say thank you for all his good deeds. Happy tears rolled down his wrinkled face when he saw how much everyone cared. Mr. Thomas showed everyone that being kind and helpful makes the world a better and happier place for all.`;
        
        let synth = window.speechSynthesis;
        let utterance = null;
        let words = [];
        let currentWordIndex = 0;
        let isPaused = false;
        let voices = [];
        
        // Load voices
        function loadVoices() {
            voices = synth.getVoices();
            const englishVoices = voices.filter(voice => voice.lang.startsWith('en'));
            const childVoices = englishVoices.filter(voice => 
                voice.name.includes('Google UK English Female') ||
                voice.name.includes('Samantha') ||
                voice.name.includes('Victoria') ||
                voice.name.includes('Karen') ||
                voice.name.includes('Google US English Female') ||
                voice.name.toLowerCase().includes('female')
            );
            const selectedVoice = childVoices.length > 0 ? childVoices[0] : englishVoices[0];
            window.selectedVoiceIndex = voices.indexOf(selectedVoice);
        }
        
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = loadVoices;
        }
        loadVoices();
        
        // Start reading
        function startReading() {
            synth.cancel();
            
            if (isPaused) {
                synth.resume();
                isPaused = false;
            } else {
                currentWordIndex = 0;
                
                utterance = new SpeechSynthesisUtterance(story);
                
                if (voices[window.selectedVoiceIndex]) {
                    utterance.voice = voices[window.selectedVoiceIndex];
                }
                
                utterance.rate = 0.9; // Fixed speed at normal pace
                utterance.pitch = 1.4;
                
                utterance.onend = function() {
                    synth.cancel();
                    isPaused = false;
                };
                
                utterance.onerror = function(event) {
                    console.error('Speech synthesis error:', event);
                    synth.cancel();
                    isPaused = false;
                };
                
                synth.speak(utterance);
            }
        }
        
        function pauseReading() {
            synth.pause();
            isPaused = true;
        }
        
        function restartReading() {
            synth.cancel();
            isPaused = false;
            currentWordIndex = 0;
            // Automatically start reading again
            startReading();
        }
        
    </script>
</body>
</html>